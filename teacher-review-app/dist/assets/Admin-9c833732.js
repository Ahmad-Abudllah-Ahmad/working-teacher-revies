import{r as l,j as e,L as z,a as je,b as ve,R as be,c as Q}from"./index-9421cb2d.js";import{b as oe,s as b,a as ne,t as re,r as xe}from"./api-5fb399bc.js";const Ne=({onLogin:r})=>{const[x,h]=l.useState(""),[d,u]=l.useState(""),[y,j]=l.useState(null),[T,C]=l.useState(!1),c=async v=>{if(v.preventDefault(),!x.trim()||!d.trim()){j("Please enter both username and password");return}C(!0),j(null);try{await new Promise(I=>setTimeout(I,1e3)),x==="admin"&&d==="admin123"?(localStorage.setItem("admin_token","demo-token-123"),r(!0)):j("Invalid username or password")}catch{j("An error occurred during login. Please try again.")}finally{C(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 bg-gray-50",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Teacher Review Platform"}),e.jsx("h3",{className:"mt-2 text-center text-2xl font-bold text-gray-800",children:"Admin Panel || developed by A.A.Ahmad"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Access the teacher review platform admin panel"})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:c,children:[e.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"sr-only",children:"Username"}),e.jsx("input",{id:"username",name:"username",type:"text",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Username",value:x,onChange:v=>h(v.target.value),disabled:T})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),e.jsx("input",{id:"password",name:"password",type:"password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Password",value:d,onChange:v=>u(v.target.value),disabled:T})]})]}),y&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-sm font-medium text-red-800",children:y})})]})}),e.jsx("div",{children:e.jsx("button",{type:"submit",className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",disabled:T,children:T?"Signing in...":"Sign in"})}),e.jsx("div",{className:"mt-4",children:e.jsx(z,{to:"/",className:"group relative w-full flex justify-center py-2 px-4 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Go to Student Dashboard"})}),e.jsx("div",{className:"text-sm text-center",children:e.jsx("p",{className:"text-gray-500",children:"Developed by A.A.Ahmad"})})]})]})})},we="teacherReviewApp_imports",Se=()=>{const[r,x]=l.useState(null),[h,d]=l.useState(!0),[u,y]=l.useState("disconnected"),j=async()=>{try{d(!0);const v=(await ne.get("/teachers")).data||[],g=(await ne.get("/reviews")).data||[];let A=[];try{const s=localStorage.getItem(we);s&&(A=JSON.parse(s).slice(0,5))}catch(s){console.error("Error loading import history:",s)}const n=g.filter(s=>s.status==="pending").length;let F=0;if(g.length>0){const s=g.reduce((w,R)=>R.metrics?w+R.rating:w,0);F=g.length>0?s/g.length:0}const M={},D={};g.forEach(s=>{s.metrics&&(M[s.teacherId]||(M[s.teacherId]=0,D[s.teacherId]=0),M[s.teacherId]+=s.rating,D[s.teacherId]+=1)});const J=v.filter(s=>D[s.id]>0).map(s=>({id:s.id,name:s.name,rating:D[s.id]?M[s.id]/D[s.id]:0,reviewsCount:D[s.id]||0})).sort((s,w)=>w.rating-s.rating).slice(0,3),O={positive:g.filter(s=>s.sentiment==="positive").length,neutral:g.filter(s=>s.sentiment==="neutral").length,negative:g.filter(s=>s.sentiment==="negative").length},H={totalTeachers:v.length,totalReviews:g.length,averageRating:F,pendingReviews:n,recentImports:A,topRatedTeachers:J,sentimentBreakdown:O};x(H),y("connected")}catch(c){console.error("Error calculating dashboard stats:",c),y("disconnected"),x({totalTeachers:0,totalReviews:0,averageRating:0,pendingReviews:0,recentImports:[],topRatedTeachers:[],sentimentBreakdown:{positive:0,neutral:0,negative:0}})}finally{d(!1)}};if(l.useEffect(()=>{j();const c=oe(j,j);return b.on("connect",()=>{y("connected"),console.log("Socket connected"),j()}),b.on("disconnect",()=>{y("disconnected"),console.log("Socket disconnected")}),()=>{c(),b.off("connect"),b.off("disconnect")}},[]),h)return e.jsx("div",{className:"h-full w-full flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-pulse text-xl",children:"Loading dashboard data..."})});if(!r)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-xl text-red-600",children:"Failed to load dashboard data"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 btn-primary",children:"Try Again"})]});const T=c=>new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),C=c=>{switch(c){case"success":return e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:"Success"});case"error":return e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-800",children:"Failed"});default:return e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800",children:"Processing"})}};return e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Dashboard"}),!u&&e.jsx("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:e.jsx("p",{className:"text-yellow-700",children:"Working in offline mode. Data shown may not be up to date."})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Total Teachers"}),e.jsx("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:r.totalTeachers}),e.jsx("div",{className:"mt-1",children:e.jsx(z,{to:"/admin/teachers",className:"text-sm text-primary-600 hover:text-primary-800",children:"View all teachers"})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Total Reviews"}),e.jsx("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:r.totalReviews}),e.jsx("div",{className:"mt-1",children:e.jsx(z,{to:"/admin/reviews",className:"text-sm text-primary-600 hover:text-primary-800",children:"View all reviews"})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Average Rating"}),e.jsx("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:r.averageRating.toFixed(1)}),e.jsx("div",{className:"mt-1 flex items-center",children:[...Array(5)].map((c,v)=>e.jsx("svg",{className:`w-4 h-4 ${v<Math.round(r.averageRating)?"text-yellow-400":"text-gray-300"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},v))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Pending Reviews"}),e.jsx("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:r.pendingReviews}),e.jsx("div",{className:"mt-1",children:e.jsx(z,{to:"/admin/reviews",className:"text-sm text-primary-600 hover:text-primary-800",children:"Moderate reviews"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Top Rated Teachers"})}),e.jsxs("div",{className:"p-6",children:[r.topRatedTeachers.length>0?e.jsx("ul",{className:"divide-y divide-gray-200",children:r.topRatedTeachers.map(c=>e.jsxs("li",{className:"py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:c.name}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("div",{className:"flex",children:[...Array(5)].map((v,I)=>e.jsx("svg",{className:`w-4 h-4 ${I<Math.round(c.rating)?"text-yellow-400":"text-gray-300"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},I))}),e.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:[c.rating.toFixed(1)," (",c.reviewsCount," reviews)"]})]})]}),e.jsx(z,{to:`/admin/teachers/${c.id}`,className:"text-sm text-primary-600 hover:text-primary-800",children:"View"})]},c.id))}):e.jsx("div",{className:"text-center py-6 text-gray-500",children:"No teacher ratings yet"}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx(z,{to:"/admin/teachers",className:"text-sm text-primary-600 hover:text-primary-800",children:"View all teachers"})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Review Sentiment Analysis"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"relative pt-1",children:[e.jsxs("div",{className:"flex mb-2 items-center justify-between",children:[e.jsx("div",{children:e.jsx("span",{className:"text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full bg-green-100 text-green-800",children:"Positive"})}),e.jsx("div",{className:"text-right",children:e.jsxs("span",{className:"text-xs font-semibold inline-block text-green-800",children:[r.sentimentBreakdown.positive," reviews"]})})]}),e.jsx("div",{className:"overflow-hidden h-2 mb-4 text-xs flex rounded bg-green-200",children:e.jsx("div",{style:{width:`${r.totalReviews?r.sentimentBreakdown.positive/r.totalReviews*100:0}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-green-500"})})]}),e.jsxs("div",{className:"relative pt-1",children:[e.jsxs("div",{className:"flex mb-2 items-center justify-between",children:[e.jsx("div",{children:e.jsx("span",{className:"text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full bg-blue-100 text-blue-800",children:"Neutral"})}),e.jsx("div",{className:"text-right",children:e.jsxs("span",{className:"text-xs font-semibold inline-block text-blue-800",children:[r.sentimentBreakdown.neutral," reviews"]})})]}),e.jsx("div",{className:"overflow-hidden h-2 mb-4 text-xs flex rounded bg-blue-200",children:e.jsx("div",{style:{width:`${r.totalReviews?r.sentimentBreakdown.neutral/r.totalReviews*100:0}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-500"})})]}),e.jsxs("div",{className:"relative pt-1",children:[e.jsxs("div",{className:"flex mb-2 items-center justify-between",children:[e.jsx("div",{children:e.jsx("span",{className:"text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full bg-red-100 text-red-800",children:"Negative"})}),e.jsx("div",{className:"text-right",children:e.jsxs("span",{className:"text-xs font-semibold inline-block text-red-800",children:[r.sentimentBreakdown.negative," reviews"]})})]}),e.jsx("div",{className:"overflow-hidden h-2 mb-4 text-xs flex rounded bg-red-200",children:e.jsx("div",{style:{width:`${r.totalReviews?r.sentimentBreakdown.negative/r.totalReviews*100:0}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-red-500"})})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Based on sentiment analysis of ",r.totalReviews," reviews"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Recent Imports"})}),e.jsxs("div",{className:"p-6",children:[r.recentImports.length>0?e.jsx("ul",{className:"divide-y divide-gray-200",children:r.recentImports.map(c=>e.jsxs("li",{className:"py-4 flex justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:c.filename}),e.jsxs("p",{className:"text-sm text-gray-500",children:[T(c.timestamp)," Â· ",c.teachersCount," teachers"]})]}),e.jsx("div",{children:C(c.status)})]},c.id))}):e.jsx("div",{className:"text-center py-6 text-gray-500",children:"No recent imports"}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx(z,{to:"/admin/import",className:"text-sm text-primary-600 hover:text-primary-800",children:"Import teachers"})})]})]})]})]})};const q="teacherReviewApp_teachers",ke=()=>{const[r,x]=l.useState([]),[h,d]=l.useState(!0),[u,y]=l.useState(""),[j,T]=l.useState(!1),[C,c]=l.useState(!1),[v,I]=l.useState(!1),[g,A]=l.useState(null),[n,F]=l.useState({name:"",field:"",experience:0,photo:"",bio:""}),[M,D]=l.useState("disconnected"),[J,O]=l.useState(!1),[H,s]=l.useState(!1),[w,R]=l.useState(null),a=l.useRef(null),f=l.useRef(null),[P,o]=l.useState(null),B=async()=>{try{d(!0);const i=(await re.getAll()).data;x(i),localStorage.setItem(q,JSON.stringify(i)),D("connected"),o(null)}catch(t){console.error("Error fetching teachers:",t),D("disconnected");const i=localStorage.getItem(q);if(i)try{x(JSON.parse(i))}catch(p){console.error("Error parsing cached teachers:",p)}o("Could not connect to server. Working with local data.")}finally{d(!1)}},[U,ee]=l.useState([]);l.useEffect(()=>{B();const t=oe(B,()=>{});return b.on("connect",()=>{D("connected"),console.log("Socket connected"),B()}),b.on("disconnect",()=>{D("disconnected"),console.log("Socket disconnected")}),()=>{t(),b.off("connect"),b.off("disconnect")}},[]),l.useEffect(()=>{!h&&r.length>0&&localStorage.setItem(q,JSON.stringify(r))},[r,h]);const S=t=>{const{name:i,value:p}=t.target;F(m=>({...m,[i]:i==="experience"?parseInt(p)||0:p}))},te=t=>{t.target.files&&t.target.files.length>0&&ce(t.target.files[0])},le=t=>{t.preventDefault(),O(!0)},G=t=>{t.preventDefault(),s(!0)},se=t=>{t.preventDefault(),O(!1)},Z=t=>{t.preventDefault(),s(!1)},K=t=>{t.preventDefault(),O(!1),t.dataTransfer.files&&t.dataTransfer.files.length>0&&ce(t.dataTransfer.files[0])},ae=t=>{t.preventDefault(),s(!1),t.dataTransfer.files&&t.dataTransfer.files.length>0&&de(t.dataTransfer.files[0])},pe=t=>{t.target.files&&t.target.files.length>0&&de(t.target.files[0])},ce=t=>{if(!t.type.match("image.*")){alert("Please select an image file (jpg, png, etc.)");return}if(t.size>5*1024*1024){alert("Image is too large. Please select an image smaller than 5MB.");return}o("Processing image...");const i=new FileReader;i.onerror=()=>{o(null),alert("Failed to read the image file. Please try again with a different image.")},i.onload=p=>{var N;const m=new Image;m.onerror=()=>{o(null),alert("Failed to process the image. Please try a different image format.")},m.onload=()=>{try{const k=document.createElement("canvas");let L=m.width,E=m.height;const Y=600,X=500;L>E?L>Y&&(E*=Y/L,L=Y):E>X&&(L*=X/E,E=X),k.width=L,k.height=E;const $=k.getContext("2d");if($){$.fillStyle="#FFFFFF",$.fillRect(0,0,L,E),$.drawImage(m,0,0,L,E);const W=k.toDataURL("image/jpeg",.6);F(ie=>({...ie,photo:W})),R(W);const _=Math.round(W.length/1024);console.log("Image resized and optimized. New size:",_,"KB"),o(_>1e3?`Image processed (${_}KB). Size is large - consider using a smaller image.`:`Image processed successfully (${_}KB)`),W.length>1e6&&setTimeout(()=>{alert("Warning: The processed image is still quite large. This might cause upload issues. Consider using a smaller image or an external image URL instead.")},500)}}catch(k){console.error("Error processing image:",k),o(null),alert("There was a problem processing the image. Please try a different one.")}},(N=p.target)!=null&&N.result&&(m.src=p.target.result)},i.readAsDataURL(t)},de=t=>{if(!t.type.match("image.*")){alert("Please select an image file (jpg, png, etc.)");return}if(t.size>5*1024*1024){alert("Image is too large. Please select an image smaller than 5MB.");return}o("Processing image...");const i=new FileReader;i.onerror=()=>{o(null),alert("Failed to read the image file. Please try again with a different image.")},i.onload=p=>{var N;const m=new Image;m.onerror=()=>{o(null),alert("Failed to process the image. Please try a different image format.")},m.onload=()=>{try{const k=document.createElement("canvas");let L=m.width,E=m.height;const Y=600,X=500;L>E?L>Y&&(E*=Y/L,L=Y):E>X&&(L*=X/E,E=X),k.width=L,k.height=E;const $=k.getContext("2d");if($){$.fillStyle="#FFFFFF",$.fillRect(0,0,L,E),$.drawImage(m,0,0,L,E);const W=k.toDataURL("image/jpeg",.6);F(ie=>({...ie,photo:W})),R(W);const _=Math.round(W.length/1024);console.log("Edit image resized and optimized. New size:",_,"KB"),o(_>1e3?`Image processed (${_}KB). Size is large - consider using a smaller image.`:`Image processed successfully (${_}KB)`),W.length>1e6&&setTimeout(()=>{alert("Warning: The processed image is still quite large. This might cause upload issues. Consider using a smaller image or an external image URL instead.")},500)}}catch(k){console.error("Error processing image:",k),o(null),alert("There was a problem processing the image. Please try a different one.")}},(N=p.target)!=null&&N.result&&(m.src=p.target.result)},i.readAsDataURL(t)},ue=()=>{F(t=>({...t,photo:""})),R(null)},ge=()=>{F(t=>({...t,photo:""})),R(null)},fe=async t=>{if(t.preventDefault(),!n.name||!n.field||n.experience<=0||!n.bio){alert("Please fill in all required fields");return}try{if(d(!0),o("Saving teacher data..."),n.photo&&n.photo.length>2e6){d(!1),o("Image is too large (over 2MB). Please resize it or use a different image.");return}const p=(await re.create({name:n.name,field:n.field,experience:n.experience,bio:n.bio,photo:n.photo||""})).data;x(N=>[...N,p]);const m=[...r,p];localStorage.setItem(q,JSON.stringify(m)),T(!1),V(),R(null),o(null),alert(`Teacher ${n.name} has been added successfully!`)}catch(i){if(console.error("Error adding teacher:",i),M==="disconnected"){const p={...n,id:`local-${Date.now()}`};x(N=>[...N,p]);const m=[...r,p];localStorage.setItem(q,JSON.stringify(m)),T(!1),V(),R(null),o("Teacher added locally. Changes will sync when connection is restored."),alert(`Teacher ${n.name} has been added successfully! (Note: This was saved locally only)`)}else i.message&&i.message.includes("Image")?o(i.message):o("Failed to add teacher. Please try again.")}finally{d(!1)}},ye=async t=>{if(t.preventDefault(),!!g){if(!n.name||!n.field||n.experience<=0||!n.bio){alert("Please fill in all required fields");return}try{if(d(!0),o("Updating teacher data..."),n.photo&&n.photo.length>2e6){d(!1),o("Image is too large (over 2MB). Please resize it or use a different image.");return}const p=(await re.update(g.id,{name:n.name,field:n.field,experience:n.experience,bio:n.bio,photo:n.photo})).data;x(N=>N.map(k=>k.id===g.id?p:k));const m=r.map(N=>N.id===g.id?p:N);localStorage.setItem(q,JSON.stringify(m)),c(!1),V(),o(null),alert(`Teacher ${n.name} has been updated successfully!`)}catch(i){if(console.error("Error updating teacher:",i),M==="disconnected"){const p={...g,...n};x(N=>N.map(k=>k.id===g.id?p:k));const m=r.map(N=>N.id===g.id?p:N);localStorage.setItem(q,JSON.stringify(m)),c(!1),V(),o("Teacher updated locally. Changes will sync when connection is restored.")}else i.message&&i.message.includes("Image")?o(i.message):o("Failed to update teacher. Please try again.")}finally{d(!1)}}},me=async t=>{if(window.confirm("Are you sure you want to delete this teacher? This will also remove all associated reviews."))try{d(!0),await re.delete(t),x(p=>p.filter(m=>m.id!==t));const i=r.filter(p=>p.id!==t);localStorage.setItem(q,JSON.stringify(i)),o(null)}catch(i){if(console.error("Error deleting teacher:",i),M==="disconnected"){x(m=>m.filter(N=>N.id!==t));const p=r.filter(m=>m.id!==t);localStorage.setItem(q,JSON.stringify(p)),o("Teacher deleted locally. Changes will sync when connection is restored.")}else o("Failed to delete teacher. Please try again.")}finally{d(!1)}},V=()=>{F({name:"",field:"",experience:0,photo:"",bio:""}),A(null),R(null),o(null)};return l.useEffect(()=>{const t=r.filter(i=>i.name.toLowerCase().includes(u.toLowerCase())||i.field.toLowerCase().includes(u.toLowerCase()));ee(t)},[u,r]),l.useEffect(()=>{const t=()=>D("connected"),i=()=>D("disconnected");return b.on("connect",t),b.on("disconnect",i),()=>{b.off("connect",t),b.off("disconnect",i)}},[]),l.useEffect(()=>{const t=()=>{B()};return b.on("teacher_updated",t),()=>{b.off("teacher_updated",t)}},[]),h?e.jsx("div",{className:"h-full w-full flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-pulse text-xl",children:"Loading teachers..."})}):e.jsxs("div",{className:"teacher-management",children:[e.jsxs("div",{className:"teacher-management-header",children:[e.jsx("h2",{children:"Teacher Management"}),M==="disconnected"&&e.jsxs("div",{className:"connection-warning",children:[e.jsx("span",{className:"connection-indicator disconnected"}),e.jsx("p",{children:"Working in offline mode. The server at port 5001 appears to be down or inaccessible. Changes will be saved locally and synced when connection is restored."})]}),M==="connected"&&e.jsxs("div",{className:"connection-success",children:[e.jsx("span",{className:"connection-indicator connected"}),e.jsx("p",{children:"Connected to server"})]}),P&&e.jsxs("div",{className:"error-message",children:[e.jsx("p",{children:P}),e.jsx("button",{className:"dismiss-button",onClick:()=>o(null),children:"Dismiss"})]})]}),e.jsxs("div",{className:"search-section",children:[e.jsx("input",{type:"text",placeholder:"Search teachers...",value:u,onChange:t=>y(t.target.value),className:"search-input"}),e.jsx("button",{className:"add-button",onClick:()=>{V(),T(!0)},children:"Add New Teacher"})]}),h?e.jsxs("div",{className:"loading-indicator",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Loading teachers..."})]}):e.jsx(e.Fragment,{children:U.length===0?e.jsx("div",{className:"no-results",children:e.jsx("p",{children:u?"No teachers match your search.":"No teachers added yet."})}):e.jsx("div",{className:"teacher-list",children:U.map(t=>e.jsxs("div",{className:`teacher-card ${t.id.startsWith("local-")?"local-only":""}`,children:[t.id.startsWith("local-")&&e.jsx("div",{className:"local-indicator",children:e.jsx("span",{children:"Pending sync"})}),e.jsx("div",{className:"teacher-photo",children:e.jsx("img",{src:t.photo||"/assets/images/teacher-placeholder.jpg",alt:t.name,onError:i=>{i.target.src="/assets/images/teacher-placeholder.jpg"}})}),e.jsxs("div",{className:"teacher-details",children:[e.jsx("h3",{children:t.name}),e.jsx("p",{className:"field",children:t.field}),e.jsxs("p",{className:"experience",children:[t.experience," years experience"]}),e.jsxs("div",{className:"teacher-actions",children:[e.jsx("button",{className:"edit-button",onClick:()=>{A(t),F({name:t.name,field:t.field,experience:t.experience,bio:t.bio,photo:t.photo||""}),R(t.photo||null),c(!0)},children:"Edit"}),e.jsx("button",{className:"delete-button",onClick:()=>me(t.id),children:"Delete"})]})]})]},t.id))})}),j&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Add New Teacher"}),P&&e.jsx("div",{className:"mt-2 text-sm text-amber-600",children:P})]}),e.jsxs("form",{onSubmit:fe,children:[e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-900 mb-1",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"name",id:"name",className:"input-field add-teacher-input",value:n.name,onChange:S,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"field",className:"block text-sm font-medium text-gray-900 mb-1",children:["Field ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"field",id:"field",className:"input-field add-teacher-input",value:n.field,onChange:S,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"experience",className:"block text-sm font-medium text-gray-900 mb-1",children:["Experience (years) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",name:"experience",id:"experience",min:"1",className:"input-field add-teacher-input",value:n.experience,onChange:S,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"photo",className:"block text-sm font-medium text-gray-900 mb-1",children:"Photo"}),e.jsxs("div",{className:`mt-1 border-2 border-dashed rounded-md p-4 text-center ${J?"border-primary-500 bg-primary-50":"border-gray-300"}`,onDragOver:le,onDragLeave:se,onDrop:K,children:[e.jsx("input",{type:"file",ref:a,accept:"image/*",className:"hidden",onChange:te}),w?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:w,alt:"Teacher preview",className:"mx-auto h-40 w-40 object-cover rounded-md"}),e.jsx("button",{type:"button",onClick:ue,className:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Or enter a URL directly:"}),e.jsx("input",{type:"text",name:"photo",id:"photo-url",className:"input-field add-teacher-input",value:n.photo,onChange:S,placeholder:"https://example.com/image.jpg"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{className:"text-sm text-gray-500",children:"Drag and drop an image here, or"}),e.jsx("button",{type:"button",onClick:()=>{var t;return(t=a.current)==null?void 0:t.click()},className:"text-primary-600 hover:text-primary-700 font-medium text-sm",children:"Browse files"}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 10MB"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Or enter a URL directly:"}),e.jsx("input",{type:"text",name:"photo",id:"photo-direct-url",className:"input-field add-teacher-input",value:n.photo,onChange:S,placeholder:"https://example.com/image.jpg"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-900 mb-1",children:["Bio ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{name:"bio",id:"bio",rows:3,className:"input-field add-teacher-input",value:n.bio,onChange:S,required:!0})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end space-x-2",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{T(!1),V()},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:h,children:h?"Adding...":"Add Teacher"})]})]})]})}),C&&g&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Edit Teacher"}),P&&e.jsx("div",{className:"mt-2 text-sm text-amber-600",children:P})]}),e.jsxs("form",{onSubmit:ye,children:[e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"edit-name",className:"block text-sm font-medium text-gray-900 mb-1",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"name",id:"edit-name",className:"input-field edit-teacher-input",value:n.name,onChange:S,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"edit-field",className:"block text-sm font-medium text-gray-900 mb-1",children:["Field ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"field",id:"edit-field",className:"input-field edit-teacher-input",value:n.field,onChange:S,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"edit-experience",className:"block text-sm font-medium text-gray-900 mb-1",children:["Experience (years) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",name:"experience",id:"edit-experience",min:"1",className:"input-field edit-teacher-input",value:n.experience,onChange:S,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-photo",className:"block text-sm font-medium text-gray-900 mb-1",children:"Photo"}),e.jsxs("div",{className:`mt-1 border-2 border-dashed rounded-md p-4 text-center ${H?"border-primary-500 bg-primary-50":"border-gray-300"}`,onDragOver:G,onDragLeave:Z,onDrop:ae,children:[e.jsx("input",{type:"file",ref:f,accept:"image/*",className:"hidden",onChange:pe}),w?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:w,alt:"Teacher preview",className:"mx-auto h-40 w-40 object-cover rounded-md"}),e.jsx("button",{type:"button",onClick:ge,className:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Or enter a URL directly:"}),e.jsx("input",{type:"text",name:"photo",id:"edit-photo",className:"input-field edit-teacher-input",value:n.photo,onChange:S,placeholder:"https://example.com/image.jpg"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{className:"text-sm text-gray-500",children:"Drag and drop an image here, or"}),e.jsx("button",{type:"button",onClick:()=>{var t;return(t=f.current)==null?void 0:t.click()},className:"text-primary-600 hover:text-primary-700 font-medium text-sm",children:"Browse files"}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 10MB"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Or enter a URL directly:"}),e.jsx("input",{type:"text",name:"photo",id:"edit-photo-url",className:"input-field edit-teacher-input",value:n.photo,onChange:S,placeholder:"https://example.com/image.jpg"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"edit-bio",className:"block text-sm font-medium text-gray-900 mb-1",children:["Bio ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{name:"bio",id:"edit-bio",rows:3,className:"input-field edit-teacher-input",value:n.bio,onChange:S,required:!0})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end space-x-2",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{c(!1),V()},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:h,children:h?"Saving...":"Save Changes"})]})]})]})}),v&&g&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Confirm Deletion"})}),e.jsx("div",{className:"p-6",children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Are you sure you want to delete ",e.jsx("span",{className:"font-medium",children:g.name}),"? This action cannot be undone and will also remove all associated reviews."]})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end space-x-2",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{I(!1),A(null)},children:"Cancel"}),e.jsx("button",{type:"button",className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-md shadow-sm transition-colors",onClick:()=>me(g.id),children:"Delete"})]})]})})]})},he="teacherReviewApp_imports",Ce=()=>{const[r,x]=l.useState(!1),[h,d]=l.useState(null),[u,y]=l.useState([]),[j,T]=l.useState(!1),[C,c]=l.useState([]),[v,I]=l.useState(!1),[g,A]=l.useState(b.connected),n=l.useRef(null);l.useEffect(()=>((()=>{try{const f=localStorage.getItem(he);f&&y(JSON.parse(f))}catch(f){console.error("Error loading import history from localStorage:",f)}})(),b.on("connect",()=>{A(!0)}),b.on("disconnect",()=>{A(!1)}),()=>{b.off("connect"),b.off("disconnect")}),[]),l.useEffect(()=>{u.length>0&&localStorage.setItem(he,JSON.stringify(u))},[u]);const F=a=>{a.preventDefault(),x(!0)},M=a=>{a.preventDefault(),x(!1)},D=a=>{a.preventDefault(),x(!1),a.dataTransfer.files&&a.dataTransfer.files.length>0&&O(a.dataTransfer.files[0])},J=a=>{a.target.files&&a.target.files.length>0&&O(a.target.files[0])},O=a=>{if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv","application/json"].includes(a.type)&&!a.name.endsWith(".csv")&&!a.name.endsWith(".json")&&!a.name.endsWith(".xlsx")&&!a.name.endsWith(".xls")){alert("Please upload a valid Excel, CSV, or JSON file");return}d(a),H(a)},H=a=>{const f=new FileReader;f.onload=P=>{var o,B;try{let U=[];if(a.type==="application/json"||a.name.endsWith(".json")){const S=(o=P.target)==null?void 0:o.result;U=JSON.parse(S)}else if(a.type==="text/csv"||a.name.endsWith(".csv")){const te=((B=P.target)==null?void 0:B.result).split(`
`),le=te[0].split(",").map(G=>G.trim());U=te.slice(1).filter(G=>G.trim()).map(G=>{const se=G.split(",").map(K=>K.trim()),Z={};return le.forEach((K,ae)=>{K==="experience"?Z[K]=parseInt(se[ae])||0:Z[K]=se[ae]||""}),Z})}else U=[{name:"Dr. Alice Williams",field:"Biology",experience:8,bio:"Specializes in molecular biology"},{name:"Prof. Robert Chen",field:"Engineering",experience:12,bio:"Expert in mechanical engineering"},{name:"Dr. Sarah Miller",field:"Psychology",experience:7,bio:"Focuses on cognitive psychology"}];const ee=U.filter(S=>S.name&&S.field&&typeof S.experience=="number"&&S.bio);if(ee.length===0){alert("No valid teacher data found in the file. Each teacher must have name, field, experience, and bio."),d(null);return}c(ee),I(!0)}catch(U){console.error("Error parsing file:",U),alert("Error parsing file. Please check the file format and try again."),d(null)}},a.type==="application/json"||a.name.endsWith(".json")||a.type==="text/csv"||a.name.endsWith(".csv")?f.readAsText(a):setTimeout(()=>{f.onload&&f.onload({target:{result:""}})},500)},s=async()=>{if(!h||C.length===0)return;T(!0);const a=Date.now().toString(),f={id:a,timestamp:new Date().toISOString(),filename:h.name,teachersCount:C.length,status:"processing"};y(P=>[f,...P]);try{for(const o of C)try{await ne.post("/teachers",o)}catch(B){console.error("Error importing teacher:",o.name,B)}const P={...f,status:"success"};y(o=>o.map(B=>B.id===a?P:B)),alert(`Successfully imported ${C.length} teachers!`)}catch(P){console.error("Error during import:",P);const o={...f,status:"error",errorMessage:"Failed to import teachers. Please try again."};y(B=>B.map(U=>U.id===a?o:U)),alert("Error importing teachers. Please try again.")}finally{T(!1),d(null),I(!1),c([])}},w=()=>{d(null),I(!1),c([])},R=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Import Teachers"}),!g&&e.jsx("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:e.jsx("p",{className:"text-yellow-700",children:"Working in offline mode. Imports will be stored locally and synced when connection is restored."})}),!v&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Upload an Excel, CSV, or JSON file containing teacher data. Each teacher should have the following fields:"}),e.jsxs("ul",{className:"list-disc list-inside mb-6 text-gray-600",children:[e.jsx("li",{children:"name (required): Full name of the teacher"}),e.jsx("li",{children:"field (required): Field of study or department"}),e.jsx("li",{children:"experience (required): Years of experience as a number"}),e.jsx("li",{children:"bio (required): Short biography or description"}),e.jsx("li",{children:"photo (optional): URL to teacher's photo"})]}),e.jsxs("div",{className:`mt-4 p-6 border-2 border-dashed rounded-lg text-center ${r?"border-primary-500 bg-primary-50":"border-gray-300"}`,onDragOver:F,onDragLeave:M,onDrop:D,children:[e.jsx("input",{type:"file",ref:n,onChange:J,accept:".xlsx,.xls,.csv,.json",className:"hidden"}),h?e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-700 font-medium",children:h.name}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[(h.size/1024).toFixed(2)," KB"]}),e.jsx("div",{className:"mt-4 flex justify-center space-x-3",children:e.jsx("button",{className:"btn-secondary text-sm",onClick:()=>d(null),children:"Remove"})})]}):e.jsxs("div",{children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsxs("p",{className:"text-gray-500 mt-2",children:["Drag and drop a file here, or",e.jsx("button",{type:"button",className:"text-primary-600 hover:text-primary-800 font-medium ml-1",onClick:()=>{var a;return(a=n.current)==null?void 0:a.click()},children:"browse"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Supported formats: .xlsx, .xls, .csv, .json"})]})]})]}),v&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Preview Data"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Showing ",C.length>5?"5 of "+C.length:C.length," teachers from ",h==null?void 0:h.name]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Field"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Experience"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bio"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.slice(0,5).map((a,f)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:a.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.field}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[a.experience," years"]}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:a.bio})]},f))})]})}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:w,disabled:j,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:s,disabled:j,children:j?"Importing...":`Import ${C.length} Teachers`})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Import History"})}),u.length>0?e.jsx("div",{className:"divide-y divide-gray-200",children:u.map(a=>e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:a.filename}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:R(a.timestamp)})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:"text-sm text-gray-600 mr-3",children:[a.teachersCount," teachers"]}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${a.status==="success"?"bg-green-100 text-green-800":a.status==="error"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:a.status==="success"?"Success":a.status==="error"?"Failed":"Processing"})]})]}),a.errorMessage&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:a.errorMessage})]},a.id))}):e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No import history available"})]})]})},Re=()=>{const[r,x]=l.useState([]),[h,d]=l.useState(!0),[u,y]=l.useState("all"),[j,T]=l.useState(""),[C,c]=l.useState(!1),[v,I]=l.useState(null),[g,A]=l.useState("disconnected"),n=async()=>{try{d(!0);const s=await ne.get("/reviews");console.log("Fetched reviews:",s.data),x(s.data),A("connected")}catch(s){console.error("Error fetching reviews:",s),A("disconnected"),x([])}finally{d(!1)}};l.useEffect(()=>{n();const s=oe(n,n);return b.on("connect",()=>{A("connected"),console.log("Socket connected"),n()}),b.on("disconnect",()=>{A("disconnected"),console.log("Socket disconnected")}),()=>{s(),b.off("connect"),b.off("disconnect")}},[]);const F=async(s,w)=>{try{if(!r.find(a=>a.id===s))return;await xe.updateStatus(s,w),x(a=>a.map(f=>f.id===s?{...f,status:w}:f))}catch(R){console.error("Error updating review status:",R),alert("Failed to update review status. Please try again.")}},M=async()=>{if(v)try{await xe.delete(v.id),x(s=>s.filter(w=>w.id!==v.id)),c(!1),I(null)}catch(s){console.error("Error deleting review:",s),alert("Failed to delete review. Please try again."),c(!1),I(null)}},D=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),J=s=>{switch(s){case"approved":return e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:"Approved"});case"pending":return e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800",children:"Pending"});case"flagged":return e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-orange-100 text-orange-800",children:"Flagged"});case"removed":return e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-800",children:"Removed"});default:return null}},O=s=>{switch(s){case"positive":return e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:"Positive"});case"neutral":return e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:"Neutral"});case"negative":return e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-800",children:"Negative"});default:return null}},H=r.filter(s=>{const w=u==="all"||s.status===u,R=s.comment.toLowerCase().includes(j.toLowerCase())||s.teacherName.toLowerCase().includes(j.toLowerCase());return w&&R});return h?e.jsx("div",{className:"h-full w-full flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-pulse text-xl",children:"Loading reviews..."})}):e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Review Moderation"}),g==="disconnected"&&e.jsx("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:e.jsx("p",{className:"text-yellow-700",children:"Working in offline mode. Changes may not be saved until connection is restored."})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{className:`px-3 py-1 text-sm rounded-md ${u==="all"?"bg-primary-100 text-primary-800":"bg-gray-100 text-gray-800"}`,onClick:()=>y("all"),children:"All"}),e.jsx("button",{className:`px-3 py-1 text-sm rounded-md ${u==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,onClick:()=>y("pending"),children:"Pending"}),e.jsx("button",{className:`px-3 py-1 text-sm rounded-md ${u==="approved"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,onClick:()=>y("approved"),children:"Approved"}),e.jsx("button",{className:`px-3 py-1 text-sm rounded-md ${u==="flagged"?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-800"}`,onClick:()=>y("flagged"),children:"Flagged"}),e.jsx("button",{className:`px-3 py-1 text-sm rounded-md ${u==="removed"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,onClick:()=>y("removed"),children:"Removed"})]}),e.jsxs("div",{className:"relative flex-grow max-w-md",children:[e.jsx("input",{type:"text",placeholder:"Search by review text or teacher name...",className:"w-full px-4 py-2 border border-gray-300 rounded-md pr-10",value:j,onChange:s=>T(s.target.value)}),e.jsx("svg",{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]})}),e.jsx("div",{className:"space-y-4",children:H.length>0?H.map(s=>e.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Review for ",s.teacherName]}),e.jsx("p",{className:"text-sm text-gray-500",children:D(s.createdAt)})]}),e.jsxs("div",{className:"flex space-x-2 mt-2 md:mt-0",children:[O(s.sentiment),J(s.status)]})]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-md mb-4",children:e.jsx("p",{className:"text-gray-700",children:s.comment})}),s.metrics&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Overall Grade"}),e.jsxs("p",{className:"font-medium",children:[s.metrics.overallGrade,"/5"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Teaching Quality"}),e.jsxs("p",{className:"font-medium",children:[s.metrics.teachingQuality,"/5"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Attendance & Support"}),e.jsxs("p",{className:"font-medium",children:[s.metrics.attendanceSupport,"/5"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Professional Behavior"}),e.jsxs("p",{className:"font-medium",children:[s.metrics.professionalBehavior,"/5"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.status!=="approved"&&e.jsx("button",{onClick:()=>F(s.id,"approved"),className:"px-3 py-1 text-sm bg-green-100 text-green-800 rounded-md hover:bg-green-200",children:"Approve"}),s.status!=="flagged"&&e.jsx("button",{onClick:()=>F(s.id,"flagged"),className:"px-3 py-1 text-sm bg-orange-100 text-orange-800 rounded-md hover:bg-orange-200",children:"Flag for Review"}),e.jsx("button",{onClick:()=>{I(s),c(!0)},className:"px-3 py-1 text-sm bg-red-100 text-red-800 rounded-md hover:bg-red-200",children:"Remove"})]})]})},s.id)):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center",children:[e.jsx("p",{className:"text-gray-500",children:"No reviews found matching your filters."}),u!=="all"&&e.jsx("button",{onClick:()=>y("all"),className:"mt-2 text-primary-600 hover:text-primary-800",children:"Show all reviews"}),j&&e.jsx("button",{onClick:()=>T(""),className:"mt-2 ml-4 text-primary-600 hover:text-primary-800",children:"Clear search"})]})}),C&&v&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Confirm Removal"})}),e.jsx("div",{className:"p-6",children:e.jsx("p",{className:"text-sm text-gray-700",children:"Are you sure you want to remove this review? This will mark it as removed and hide it from public view."})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>{c(!1),I(null)},className:"px-4 py-2 bg-gray-100 text-gray-800 rounded-md hover:bg-gray-200",children:"Cancel"}),e.jsx("button",{onClick:M,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Remove"})]})]})})]})},De=()=>{const[r,x]=l.useState(!1),h=je(),d=ve();l.useEffect(()=>{localStorage.getItem("admin_token")?x(!0):d.pathname!=="/admin/login"&&h("/admin/login")},[h,d.pathname]);const u=j=>{j&&(x(!0),h("/admin/dashboard"))},y=()=>{localStorage.removeItem("admin_token"),x(!1),h("/admin/login")};return!r&&d.pathname!=="/admin/login"?null:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r&&e.jsx("header",{className:"bg-primary-600 text-white py-4",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"flex items-center",children:e.jsx(z,{to:"/admin/dashboard",className:"text-xl font-bold",children:"Admin Panel"})}),e.jsxs("nav",{className:"hidden md:flex space-x-6",children:[e.jsx(z,{to:"/admin/dashboard",className:"text-white hover:text-white/80 transition-colors",children:"Dashboard"}),e.jsx(z,{to:"/admin/teachers",className:"text-white hover:text-white/80 transition-colors",children:"Teachers"}),e.jsx(z,{to:"/admin/import",className:"text-white hover:text-white/80 transition-colors",children:"Import"}),e.jsx(z,{to:"/admin/reviews",className:"text-white hover:text-white/80 transition-colors",children:"Reviews"})]}),e.jsx("button",{onClick:y,className:"bg-white/10 hover:bg-white/20 text-white py-1 px-3 rounded-md transition-colors text-sm",children:"Logout"})]})})}),e.jsx("main",{className:r?"container mx-auto px-4 py-8":"",children:e.jsxs(be,{children:[e.jsx(Q,{path:"login",element:e.jsx(Ne,{onLogin:u})}),e.jsx(Q,{path:"dashboard",element:r?e.jsx(Se,{}):e.jsx("div",{children:"Unauthorized"})}),e.jsx(Q,{path:"teachers/*",element:r?e.jsx(ke,{}):e.jsx("div",{children:"Unauthorized"})}),e.jsx(Q,{path:"import",element:r?e.jsx(Ce,{}):e.jsx("div",{children:"Unauthorized"})}),e.jsx(Q,{path:"reviews",element:r?e.jsx(Re,{}):e.jsx("div",{children:"Unauthorized"})}),e.jsx(Q,{path:"*",element:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-xl text-gray-600",children:"Admin page not found"}),e.jsx(z,{to:"/admin/dashboard",className:"text-primary-600 hover:underline mt-2 inline-block",children:"Go to Dashboard"})]})})]})}),r&&e.jsx("footer",{className:"bg-gray-800 text-white py-4 mt-auto",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("p",{className:"text-center text-sm",children:"Teacher Review Platform - Admin Panel || developed by A.A.Ahmad"})})})]})};export{De as default};
